
(define (test16 a b)
  (define ar3 (string->radix3 10 a))
  (define a2r3 (radix3:change-base ar3 16))
  (define a2r3s (radix3->string a2r3))
  (define an (radix3->number ar3))
  (define bn (radix3->number (string->radix3 16 b)))
  (assert= a2r3s b)
  (assert= an bn))

(define (test-error type input)
  (assert-throw type (string->radix3 10 input)))

(test16 "3.14" "3.2(3d70a)")
(test16 "3.(1415929203539823008849557522123893805309734513274336283185840707964601769911504424778761061946902654867256637168)" "3.(243f6f0)")
(test16 "0.1(6)" "0.2(a)")
(test16 "0.5" "0.8")
(test16 "0.5" "0.8")
(test16 "0.375" "0.6")
(test16 "14.(285714)" "e.(492)")
(test16 "56.875" "38.e")
(test16 "0.91(6)" "0.e(a)")
(test16 "0.3(571428)" "0.5(b6d)")
(test16 "0.(0588235294117647)" "0.(0f)")
(test16 "3.4" "3.(6)")
(test16 "20.75" "14.c")
(test16 "0.(061728395)" "0.(0fcd6e9e06522c3f35ba781948b)")
(test16 "0.(02816901408450704225352112676056338)" "0.(073615a240e6c2b4481cd85689039b0ad12)")
(test16 "0" "0")
(test16 "5" "5")
(test16 "9" "9")
(test16 "0.5" "0.8")
(test16 "-2" "-2")
(test16 "-3.14" "-3.2(3d70a)")
(test16 "0.5" "0.8")
(test16 "0.5" "0.8")
(test16 "0.(02816901408450704225352112676056338)" "0.(073615a240e6c2b4481cd85689039b0ad12)")

(test-error 'empty-string "")
